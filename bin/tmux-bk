#!/bin/zsh

SESSION_NAME="tmux-bk-local"
GPG="/usr/bin/gpg"
SAMPLE_FILE="$HOME/.foo.gpg"
CONFIG_FILE="$HOME/.tmux.conf.local"
TMUX="/usr/bin/tmux"

# force unlock gpg-agent before opening tmux, because syncmail needs it to
# download my e-mail
$GPG --quiet --decrypt $SAMPLE_FILE >/dev/null

$TMUX -f $CONFIG_FILE new-session -d -s $SESSION_NAME

$TMUX new-window -t $SESSION_NAME:2 # -n 'WeeChat'
$TMUX split-window -v
$TMUX select-pane -t $SESSION_NAME:2.{top}
$TMUX send-keys "~/.start-weechat" C-m


$TMUX select-window -t $SESSION_NAME:1
$TMUX send-keys "curl wttr.in/Amsterdam" C-m
$TMUX send-keys "fortune | cowsay" C-m

$TMUX attach-session -t $SESSION_NAME
